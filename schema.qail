# QAIL Schema

table whatsapp_sessions {
  id UUID primary_key
  phone_number VARCHAR not_null
  status VARCHAR not_null
  closed_by VARCHAR
  close_reason TEXT
  last_customer_message_at TIMESTAMPTZ
  last_bot_message_at TIMESTAMPTZ
  pending_close_prompted BOOLEAN not_null
  pending_close_prompted_at TIMESTAMPTZ
  welcome_sent BOOLEAN not_null
  welcome_sent_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  closed_at TIMESTAMPTZ
  admin_takeover BOOLEAN
  admin_takeover_at TIMESTAMPTZ
  admin_takeover_by VARCHAR
}

table seo_poros {
  id UUID primary_key
  slug TEXT not_null
  origin TEXT not_null
  destination TEXT not_null
  title TEXT not_null
  meta_description TEXT
  content_paragraphs JSONB
  avg_duration TEXT
  min_price INT
  max_price INT
  departures_per_day INT
  distance TEXT
  tips JSONB
  faqs JSONB
  is_published BOOLEAN not_null
  operator_count INT
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  created_by UUID
  updated_by UUID
  origin_destination_id UUID
  dest_destination_id UUID
  origin_harbor_id UUID
  dest_harbor_id UUID
}

table payment_events {
  id BIGINT primary_key
  payment_session_id UUID not_null
  event_type TEXT not_null
  provider_id TEXT
  payload JSONB not_null
  created_at TIMESTAMPTZ not_null
  processed BOOLEAN not_null
}

table cloudflare_image_attachments {
  id UUID primary_key
  image_id UUID not_null
  entity_type TEXT not_null
  entity_id UUID not_null
  field_name TEXT
  is_featured BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table fishing_skaphos {
  id UUID primary_key
  alieus_id UUID not_null
  slug TEXT not_null
  name TEXT not_null
  vessel_type TEXT not_null
  description TEXT
  images JSONB
  capacity_min INT not_null
  capacity_max INT not_null
  crew INT not_null
  length TEXT
  year_built INT
  equipment JSONB
  features JSONB
  base_location TEXT not_null
  is_active BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
  category TEXT
  cabins INT
  amenities JSONB
  harbor_id UUID
  destination_id UUID
}

table articles {
  id UUID primary_key
  title VARCHAR not_null
  slug VARCHAR not_null
  content TEXT not_null
  excerpt TEXT
  featured_image_id VARCHAR
  featured_image_url TEXT
  meta_title VARCHAR
  meta_description TEXT
  meta_keywords TEXT
  status TEXT not_null
  is_featured BOOLEAN not_null
  allow_comments BOOLEAN not_null
  author_id UUID not_null
  published_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  view_count BIGINT not_null
  like_count BIGINT not_null
  tags JSONB
  category VARCHAR
  version INT not_null
  word_count INT not_null
  reading_time_minutes INT not_null
  deleted_at TIMESTAMPTZ
}

table odyssey_connections {
  id UUID primary_key
  odyssey_id UUID not_null
  origin_harbor_id UUID not_null
  destination_harbor_id UUID not_null
  name VARCHAR not_null
  description TEXT
  is_enabled BOOLEAN not_null
  leg_ids TEXT not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table charters_skaphos {
  id UUID primary_key
  alieus_id UUID not_null
  slug TEXT not_null
  name TEXT not_null
  vessel_type TEXT not_null
  description TEXT
  images JSONB
  capacity_min INT not_null
  capacity_max INT not_null
  crew INT not_null
  length TEXT
  year_built INT
  equipment JSONB
  features JSONB
  base_location TEXT not_null
  is_active BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
  category TEXT
  cabins INT
  amenities JSONB
  harbor_id UUID
  destination_id UUID
}

table odyssey_pricing_plans {
  id UUID primary_key
  connection_id UUID
  odyssey_id UUID not_null
  name VARCHAR not_null
  currency VARCHAR not_null
  start_date DATE not_null
  end_date DATE not_null
  priority INT not_null
  is_active BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table promotions {
  id UUID primary_key
  code VARCHAR not_null
  name VARCHAR not_null
  description TEXT
  discount_type VARCHAR not_null
  discount_value DOUBLE PRECISION not_null
  currency VARCHAR
  starts_at TIMESTAMPTZ not_null
  expires_at TIMESTAMPTZ
  is_active BOOLEAN not_null
  max_uses INT
  max_uses_per_customer INT
  current_uses INT not_null
  min_purchase_amount DOUBLE PRECISION
  max_discount_amount DOUBLE PRECISION
  applicable_routes JSONB
  applicable_operators JSONB
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  created_by UUID
}

table system_settings {
  id UUID primary_key
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  web_turnstile_secret_key TEXT
  web_turnstile_site_key TEXT
  web_recaptcha_v3_secret_key TEXT
  web_recaptcha_v3_site_key TEXT
  admin_turnstile_secret_key TEXT
  admin_turnstile_site_key TEXT
  admin_recaptcha_v3_secret_key TEXT
  admin_recaptcha_v3_site_key TEXT
  xendit_public_key TEXT
  xendit_secret_key TEXT
  xendit_webhook_verification_token TEXT
  wise_api_token TEXT
  postmark_token TEXT
  postmark_from_email TEXT
  postmark_from_name TEXT
  recaptcha_enterprise_site_key TEXT
  recaptcha_enterprise_api_key TEXT
  recaptcha_enterprise_project_id TEXT
  postmark_eticket_from_email TEXT
  postmark_eticket_from_name TEXT
  postmark_invoice_from_email TEXT
  postmark_invoice_from_name TEXT
  postmark_notify_from_email TEXT
  postmark_notify_from_name TEXT
  postmark_webhook_secret TEXT
  webhook_basic_auth_username TEXT
  webhook_basic_auth_password TEXT
  paypal_client_id TEXT
  paypal_client_secret TEXT
  paypal_webhook_id TEXT
  paypal_mode TEXT
  paypal_processing_fee_percent DOUBLE PRECISION
  telegram_bot_token TEXT
  telegram_chat_id TEXT
  telegram_thread_id TEXT
  cloudflare_images_account_id TEXT
  cloudflare_images_api_token TEXT
  cloudflare_images_hash TEXT
  doku_client_id VARCHAR
  doku_secret_key VARCHAR
  doku_is_production BOOLEAN
  company_name VARCHAR
  company_address TEXT
  support_phone VARCHAR
  support_email VARCHAR
  website_url VARCHAR
  hours_monday_open VARCHAR
  hours_monday_close VARCHAR
  hours_tuesday_open VARCHAR
  hours_tuesday_close VARCHAR
  hours_wednesday_open VARCHAR
  hours_wednesday_close VARCHAR
  hours_thursday_open VARCHAR
  hours_thursday_close VARCHAR
  hours_friday_open VARCHAR
  hours_friday_close VARCHAR
  hours_saturday_open VARCHAR
  hours_saturday_close VARCHAR
  hours_sunday_open VARCHAR
  hours_sunday_close VARCHAR
  social_instagram VARCHAR
  social_facebook VARCHAR
  social_twitter VARCHAR
  social_tiktok VARCHAR
  openai_api_key TEXT
  facebook_app_id VARCHAR
  facebook_app_secret VARCHAR
  google_client_id VARCHAR
  google_client_secret VARCHAR
}

table harbors {
  id UUID primary_key
  name TEXT not_null
  slug TEXT not_null
  timezone TEXT not_null
  position INT not_null
  is_active BOOLEAN not_null
  address TEXT
  google_maps_url TEXT
  latitude DOUBLE PRECISION
  longitude DOUBLE PRECISION
  photo_url TEXT
  map_image_url TEXT
  seo_article TEXT
  seo_title TEXT not_null
  seo_description TEXT not_null
  seo_keywords TEXT not_null
  facilities JSONB
  port_fee_amount DOUBLE PRECISION
  port_fee_description TEXT
  important_notes JSONB
  operating_hours TEXT
  contact_phone TEXT
  contact_email TEXT
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  tz_region VARCHAR
  country TEXT
  city TEXT
  description TEXT
}

table whatsapp_phone_configs {
  id UUID primary_key
  phone_number_id VARCHAR not_null
  display_name VARCHAR not_null
  phone_number VARCHAR
  waba_id VARCHAR not_null
  access_token TEXT
  is_active BOOLEAN not_null
  is_test BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  verify_token TEXT
  app_secret TEXT
  app_id TEXT
}

table vessels {
  id UUID primary_key
  operator_id UUID not_null
  default_arrival_dock_id UUID
  default_departure_dock_id UUID
  name VARCHAR not_null
  slug VARCHAR not_null
  vessel_type TEXT not_null
  vessel_class TEXT not_null
  seat_capacity INT not_null
  active_since DATE not_null
  is_active BOOLEAN not_null
  facility TEXT not_null
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table operators {
  id UUID primary_key
  parent_operator_id UUID
  default_arrival_dock_id UUID
  default_departure_dock_id UUID
  operator_type TEXT not_null
  operator_type_description TEXT
  slug VARCHAR not_null
  brand_name VARCHAR not_null
  legal_name VARCHAR not_null
  logo TEXT
  photo TEXT
  phone VARCHAR not_null
  address TEXT not_null
  description TEXT not_null
  infant_policy TEXT
  infant_policy_description TEXT
  child_age_policy TEXT
  child_age_policy_description TEXT
  refund_policy TEXT not_null
  refund_policy_description TEXT
  reschedule_policy TEXT not_null
  reschedule_policy_description TEXT
  is_active BOOLEAN not_null
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
  rating DOUBLE PRECISION
  logo_url TEXT
  lead_time_hours INT not_null
}

table schema_migrations {
  version VARCHAR primary_key
  applied_at TIMESTAMPTZ not_null
}

table pricing_plans {
  id UUID primary_key
  virtual_segment_id UUID
  name VARCHAR not_null
  currency VARCHAR not_null
  start_date DATE not_null
  end_date DATE not_null
  priority INT not_null
  is_active BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  segment_id UUID
  parent_route_id UUID
}

table charters_diathesi {
  id UUID primary_key
  drasimos_id UUID not_null
  available_date DATE not_null
  start_time TEXT
  end_time TEXT
  max_bookings INT
  current_bookings INT
  price_override INT
  notes TEXT
  is_available BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table promotion_uses {
  id UUID primary_key
  promotion_id UUID not_null
  order_id UUID not_null
  customer_email VARCHAR
  customer_id UUID
  discount_applied DOUBLE PRECISION not_null
  original_amount DOUBLE PRECISION not_null
  created_at TIMESTAMPTZ not_null
}

table holds {
  id UUID primary_key
  connection_id UUID not_null
  seats INT not_null
  expires_at TIMESTAMPTZ not_null
  status TEXT not_null
  idempotency_key TEXT
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  is_confirmed BOOLEAN not_null
}

table payment_sessions {
  id UUID primary_key
  order_id UUID not_null
  provider TEXT not_null
  session_id TEXT
  payment_id TEXT
  status TEXT not_null
  amount BIGINT not_null
  currency TEXT not_null
  channel_code TEXT
  expires_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  payment_request_id VARCHAR
  xendit_session_id VARCHAR
  completed_at TIMESTAMPTZ
  card_masked TEXT
  card_last_four TEXT
  card_type TEXT
  card_brand TEXT
  card_issuer TEXT
  card_exp_month TEXT
  card_exp_year TEXT
  card_fingerprint TEXT
  card_country TEXT
  va_bank_code TEXT
  va_virtual_account_number TEXT
  va_customer_name TEXT
  foreign_currency TEXT
  foreign_amount DOUBLE PRECISION
  processing_fee_percent DOUBLE PRECISION
  processing_fee_amount DOUBLE PRECISION
  exchange_rate DOUBLE PRECISION
}

table user_email_verifications {
  id UUID primary_key
  user_id UUID not_null
  token VARCHAR not_null
  expires_at TIMESTAMPTZ not_null
  consumed_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
}

table seo_comparisons {
  id UUID primary_key
  slug TEXT not_null
  title TEXT not_null
  description TEXT
  comparison_type TEXT not_null
  operator1_id UUID
  operator2_id UUID
  category TEXT
  intro TEXT
  criteria JSONB
  rankings JSONB
  is_published BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  created_by UUID
  updated_by UUID
}

table cloudflare_images {
  id UUID primary_key
  image_id TEXT not_null
  image_url TEXT not_null
  filename TEXT
  file_size_bytes BIGINT
  mime_type TEXT
  width INT
  height INT
  variants JSONB
  uploaded_by UUID
  uploaded_at TIMESTAMPTZ not_null
  cloudflare_created_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
  description TEXT
  alt_text TEXT
}

table whatsapp_contact_group_members {
  group_id UUID primary_key
  contact_phone VARCHAR primary_key
  contact_name VARCHAR
  added_at TIMESTAMPTZ not_null
}

table whatsapp_broadcasts {
  id UUID primary_key
  name VARCHAR not_null
  template_name VARCHAR not_null
  template_language VARCHAR not_null
  template_variables JSONB
  group_id UUID
  recipient_count INT not_null
  sent_count INT not_null
  delivered_count INT not_null
  read_count INT not_null
  failed_count INT not_null
  status VARCHAR
  created_by VARCHAR
  created_at TIMESTAMPTZ not_null
  completed_at TIMESTAMPTZ
}

table operator_boarding_points {
  id UUID primary_key
  operator_id UUID not_null
  harbor_id UUID not_null
  name VARCHAR not_null
  description TEXT
  is_active BOOLEAN not_null
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  address TEXT
  phone VARCHAR
  latitude DOUBLE PRECISION
  longitude DOUBLE PRECISION
  google_maps_url TEXT
  waze_url TEXT
  is_primary BOOLEAN not_null
  boarding_type VARCHAR not_null
  deleted_at TIMESTAMPTZ
}

table charters_drasimos {
  id UUID primary_key
  skaphos_id UUID not_null
  slug TEXT not_null
  name TEXT not_null
  tagline TEXT
  description TEXT
  charter_style TEXT not_null
  duration_type TEXT not_null
  duration_hours INT not_null
  duration_label TEXT not_null
  target_species JSONB
  departure_location TEXT not_null
  departure_time TEXT
  return_time TEXT
  inclusions JSONB
  exclusions JSONB
  what_to_bring JSONB
  trip_highlights JSONB
  schedule JSONB
  charter_techniques JSONB
  price_amount INT not_null
  price_currency TEXT
  price_type TEXT not_null
  price_label TEXT
  deposit_percent INT
  images JSONB
  is_available BOOLEAN
  is_published BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
  category TEXT
  destinations JSONB
  nights INT
}

table odyssey_leg_inventory {
  id UUID primary_key
  odyssey_id UUID not_null
  leg_id UUID not_null
  service_date DATE not_null
  capacity INT not_null
  reserved INT not_null
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table operator_facilities {
  id UUID primary_key
  operator_id UUID not_null
  name VARCHAR not_null
  description TEXT
  icon VARCHAR
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table vessel_class_options {
  id UUID primary_key
  value TEXT not_null
  label TEXT not_null
  position INT not_null
  is_active BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table order_modifications {
  id UUID primary_key
  order_id UUID not_null
  original_connection_id UUID not_null
  target_connection_id UUID not_null
  reason TEXT not_null
  status VARCHAR not_null
  admin_id UUID not_null
  customer_response_at TIMESTAMPTZ
  approval_token VARCHAR not_null
  expires_at TIMESTAMPTZ not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table ssl_certificates {
  id UUID primary_key
  domain TEXT not_null
  certificate_pem TEXT not_null
  private_key_pem TEXT not_null
  certificate_chain_pem TEXT
  issuer TEXT
  valid_from TIMESTAMPTZ
  expires_at TIMESTAMPTZ not_null
  is_active BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table seo_kairos {
  id UUID primary_key
  slug TEXT not_null
  destination TEXT not_null
  title TEXT not_null
  meta_description TEXT
  content_paragraphs JSONB
  quick_stats JSONB
  related_harbors JSONB
  tips JSONB
  is_published BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  created_by UUID
  updated_by UUID
}

table odysseys {
  id UUID primary_key
  vessel_id UUID not_null
  name VARCHAR not_null
  description TEXT
  is_active BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  booking_window_days INT not_null
  sales_lead_time_hours INT not_null
  booking_window_rollout BOOLEAN not_null
}

table ai_knowledge_base {
  id UUID primary_key
  topic VARCHAR not_null
  question TEXT not_null
  answer TEXT not_null
  keywords TEXT
  is_active BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table whatsapp_messages {
  id UUID primary_key
  phone_number VARCHAR not_null
  direction VARCHAR not_null
  message_type VARCHAR not_null
  content TEXT
  media_url TEXT
  media_mime_type VARCHAR
  wa_message_id VARCHAR
  status VARCHAR
  order_id UUID
  user_id UUID
  sender_name VARCHAR
  error_message TEXT
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  session_id UUID
  sent_at TIMESTAMPTZ
  delivered_at TIMESTAMPTZ
  read_at TIMESTAMPTZ
  our_phone_number_id VARCHAR
}

table destinations {
  id UUID primary_key
  name TEXT not_null
  slug TEXT not_null
  display_name TEXT not_null
  description TEXT
  is_active BOOLEAN not_null
  position INT not_null
  seo_title TEXT
  seo_description TEXT
  seo_keywords TEXT
  latitude DOUBLE PRECISION
  longitude DOUBLE PRECISION
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  is_popular BOOLEAN not_null
  cover_image TEXT
  gallery_images JSONB
  highlights JSONB
  travel_tips JSONB
  best_time_to_visit TEXT
  average_trip_duration TEXT
  popular_activities JSONB
  transportation_info TEXT
  local_currency TEXT
  languages_spoken JSONB
  climate_info TEXT
  safety_rating INT
  budget_level TEXT
  deleted_at TIMESTAMPTZ
}

table vessel_facilities {
  id UUID primary_key
  vessel_id UUID not_null
  name TEXT not_null
  description TEXT
  icon TEXT
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table idempotency_keys {
  key VARCHAR primary_key
  request_hash VARCHAR not_null
  response_body TEXT not_null
  response_status INT not_null
  created_at TIMESTAMPTZ not_null
  expires_at TIMESTAMPTZ not_null
}

table service_groups {
  id UUID primary_key
  name VARCHAR not_null
  description TEXT
  category VARCHAR not_null
  class VARCHAR not_null
  is_active BOOLEAN not_null
  sort_order INT not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table user_password_resets {
  id UUID primary_key
  user_id UUID not_null
  token VARCHAR not_null
  expires_at TIMESTAMPTZ not_null
  consumed_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
}

table whatsapp_contacts {
  id UUID primary_key
  phone_number VARCHAR not_null
  custom_name VARCHAR
  meta_profile_name VARCHAR
  notes TEXT
  is_blocked BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table whatsapp_broadcast_recipients {
  broadcast_id UUID primary_key
  contact_phone VARCHAR primary_key
  wa_message_id VARCHAR
  status VARCHAR
  error_message TEXT
  sent_at TIMESTAMPTZ
  delivered_at TIMESTAMPTZ
  read_at TIMESTAMPTZ
}

table fishing_drasimos {
  id UUID primary_key
  skaphos_id UUID not_null
  slug TEXT not_null
  name TEXT not_null
  tagline TEXT
  description TEXT
  fishing_style TEXT not_null
  duration_type TEXT not_null
  duration_hours INT not_null
  duration_label TEXT not_null
  target_species JSONB
  departure_location TEXT not_null
  departure_time TEXT
  return_time TEXT
  inclusions JSONB
  exclusions JSONB
  what_to_bring JSONB
  trip_highlights JSONB
  schedule JSONB
  fishing_techniques JSONB
  price_amount INT not_null
  price_currency TEXT
  price_type TEXT not_null
  price_label TEXT
  deposit_percent INT
  images JSONB
  is_available BOOLEAN
  is_published BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
  category TEXT
  destinations JSONB
  nights INT
}

table odyssey_pricing_fees {
  id UUID primary_key
  plan_id UUID not_null
  fee_type VARCHAR not_null
  name VARCHAR not_null
  amount DOUBLE PRECISION not_null
  per_pax BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
}

table odyssey_legs {
  id UUID primary_key
  odyssey_id UUID not_null
  from_harbor_id UUID not_null
  to_harbor_id UUID not_null
  sequence_order INT not_null
  departure_time TEXT not_null
  departure_day_offset INT not_null
  arrival_time TEXT not_null
  arrival_day_offset INT not_null
  dwell_minutes INT not_null
  is_enabled BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table vessel_images {
  id UUID primary_key
  vessel_id UUID not_null
  image_url TEXT not_null
  display_order INT not_null
  caption TEXT
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table redirects {
  id UUID primary_key
  source_path VARCHAR not_null
  destination_url TEXT not_null
  redirect_type INT not_null
  is_active BOOLEAN not_null
  description TEXT
  hit_count BIGINT not_null
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table popular_tickets {
  id UUID primary_key
  title VARCHAR not_null
  ribbon_text VARCHAR
  ribbon_color VARCHAR
  image_url VARCHAR
  origin_harbor_id UUID
  origin_destination_id UUID
  arrival_harbor_id UUID
  arrival_destination_id UUID
  operator_id UUID
  trip_duration VARCHAR
  base_price DOUBLE PRECISION
  display_price VARCHAR
  facilities JSONB not_null
  default_departure_date DATE
  position INT not_null
  is_active BOOLEAN not_null
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table refresh_tokens {
  id UUID primary_key
  user_id UUID not_null
  token VARCHAR not_null
  expires_at TIMESTAMPTZ not_null
  created_at TIMESTAMPTZ not_null
  revoked_at TIMESTAMPTZ
}

table odyssey_pricing_tiers {
  id UUID primary_key
  plan_id UUID not_null
  market VARCHAR not_null
  pax_type VARCHAR not_null
  base_amount DOUBLE PRECISION not_null
  created_at TIMESTAMPTZ not_null
}

table fishing_diathesi {
  id UUID primary_key
  drasimos_id UUID not_null
  available_date DATE not_null
  start_time TEXT
  end_time TEXT
  max_bookings INT
  current_bookings INT
  price_override INT
  notes TEXT
  is_available BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table charters_alieus {
  id UUID primary_key
  slug TEXT not_null
  name TEXT not_null
  description TEXT
  logo_url TEXT
  contact_email TEXT
  contact_phone TEXT
  address TEXT
  city TEXT
  rating DOUBLE PRECISION
  review_count INT
  is_verified BOOLEAN
  is_active BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table _sqlx_migrations {
  version BIGINT primary_key
  description TEXT not_null
  installed_on TIMESTAMPTZ not_null
  success BOOLEAN not_null
  checksum TEXT not_null
  execution_time BIGINT not_null
}

table schedule_patterns {
  id UUID primary_key
  frequency TEXT not_null
  interval INT not_null
  by_weekday TEXT
  by_month TEXT
  by_month_day TEXT
  start_date DATE not_null
  end_date DATE
  count INT
  until DATE
  created_at TIMESTAMPTZ not_null
}

table orders {
  id UUID primary_key
  connection_id UUID
  status TEXT not_null
  total_fare BIGINT not_null
  currency TEXT not_null
  nationality TEXT not_null
  pax_breakdown JSONB not_null
  contact_info JSONB not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  pricing_breakdown JSONB
  passenger_details JSONB
  connection_snapshot JSONB
  metadata JSONB
  invoice_number TEXT
  booking_number TEXT
  user_id UUID
  voyage_id UUID
  hold_id UUID
}

table postmark_events {
  id UUID primary_key
  event_type VARCHAR not_null
  message_id VARCHAR
  server_id INT
  message_stream VARCHAR
  recipient VARCHAR
  email VARCHAR
  sender VARCHAR
  tag VARCHAR
  delivered_at TIMESTAMPTZ
  bounced_at TIMESTAMPTZ
  received_at TIMESTAMPTZ
  changed_at TIMESTAMPTZ
  processed_at TIMESTAMPTZ not_null
  created_at TIMESTAMPTZ not_null
  bounce_type VARCHAR
  type_code INT
  bounce_description TEXT
  first_open BOOLEAN
  platform VARCHAR
  read_seconds INT
  click_location VARCHAR
  original_link TEXT
  origin VARCHAR
  suppress_sending BOOLEAN
  suppression_reason VARCHAR
  complaint_id BIGINT
  raw_payload JSONB not_null
  metadata JSONB
  processing_status VARCHAR not_null
  error_message TEXT
  source_ip TEXT
  user_agent TEXT
  request_headers JSONB
}

table qail_tls_test {
  id INT primary_key
  message TEXT not_null
  created_at TIMESTAMPTZ not_null
}

table reservations {
  id UUID primary_key
  connection_id UUID not_null
  hold_id UUID
  seats INT not_null
  nationality TEXT not_null
  pax_breakdown JSONB not_null
  price_paid BIGINT not_null
  currency TEXT not_null
  status TEXT not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table destination_harbors {
  id UUID primary_key
  destination_id UUID not_null
  harbor_id UUID not_null
  is_primary BOOLEAN not_null
  position INT not_null
  created_at TIMESTAMPTZ not_null
}

table order_requests {
  id UUID primary_key
  order_id UUID not_null
  user_id UUID
  type TEXT not_null
  status TEXT not_null
  reason TEXT not_null
  new_travel_date DATE
  admin_notes TEXT
  created_at TIMESTAMPTZ not_null
  processed_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ not_null
}

table email_templates {
  id UUID primary_key
  slug VARCHAR not_null
  name VARCHAR not_null
  description TEXT
  category VARCHAR not_null
  subject_template TEXT not_null
  html_body TEXT not_null
  text_body TEXT
  tiptap_json JSONB
  available_variables JSONB not_null
  sample_data JSONB
  is_active BOOLEAN not_null
  is_system BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  created_by UUID
  updated_by UUID
}

table operator_offices {
  id UUID primary_key
  operator_id UUID not_null
  name VARCHAR not_null
  address TEXT not_null
  phone VARCHAR
  email VARCHAR
  is_main_office BOOLEAN not_null
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table charters_kratisei {
  id UUID primary_key
  drasimos_id UUID not_null
  diathesi_id UUID
  booking_date DATE not_null
  guest_count INT not_null
  total_amount INT not_null
  deposit_amount INT not_null
  currency TEXT
  status TEXT
  payment_status TEXT
  contact_first_name TEXT not_null
  contact_last_name TEXT not_null
  contact_email TEXT not_null
  contact_phone TEXT not_null
  contact_nationality TEXT
  special_requests TEXT
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table harbor_images {
  id UUID primary_key
  harbor_id UUID not_null
  image_url TEXT not_null
  is_featured BOOLEAN not_null
  display_order INT not_null
  caption TEXT
  created_by UUID not_null
  updated_by UUID not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  deleted_at TIMESTAMPTZ
}

table pricing_tiers {
  id UUID primary_key
  plan_id UUID not_null
  market VARCHAR not_null
  pax_type VARCHAR not_null
  base_amount DOUBLE PRECISION not_null
  created_at TIMESTAMPTZ not_null
}

table whatsapp_flow_config {
  id UUID primary_key
  flow_id VARCHAR not_null
  flow_name VARCHAR not_null
  first_screen VARCHAR not_null
  trigger_type VARCHAR not_null
  is_active BOOLEAN not_null
  cta_text VARCHAR not_null
  header_text VARCHAR not_null
  body_text TEXT not_null
  footer_text VARCHAR not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table whatsapp_contact_groups {
  id UUID primary_key
  name VARCHAR not_null
  description TEXT
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table oauth_accounts {
  id UUID primary_key
  user_id UUID not_null
  provider VARCHAR not_null
  provider_user_id VARCHAR not_null
  access_token TEXT
  refresh_token TEXT
  token_expires_at TIMESTAMPTZ
  metadata JSONB
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table operator_schedule_table {
  id UUID primary_key
  company_id UUID not_null
  origin VARCHAR not_null
  destination VARCHAR not_null
  departure_time TEXT not_null
  arrival_time TEXT
  travel_duration VARCHAR
  frequency VARCHAR not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
  origin_harbor_id UUID
  destination_harbor_id UUID
}

table vessel_type_options {
  id UUID primary_key
  value TEXT not_null
  label TEXT not_null
  position INT not_null
  is_active BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table fishing_kratisei {
  id UUID primary_key
  drasimos_id UUID not_null
  diathesi_id UUID
  booking_date DATE not_null
  guest_count INT not_null
  total_amount INT not_null
  deposit_amount INT not_null
  currency TEXT
  status TEXT
  payment_status TEXT
  contact_first_name TEXT not_null
  contact_last_name TEXT not_null
  contact_email TEXT not_null
  contact_phone TEXT not_null
  contact_nationality TEXT
  special_requests TEXT
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table search_location_stats {
  id UUID primary_key
  location_type VARCHAR not_null
  location_id UUID not_null
  location_name VARCHAR not_null
  location_slug VARCHAR
  selection_count BIGINT not_null
  last_selected_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
  updated_at TIMESTAMPTZ not_null
}

table users {
  id INT primary_key
  name TEXT not_null
}

table pricing_fees {
  id UUID primary_key
  plan_id UUID not_null
  fee_type VARCHAR not_null
  name VARCHAR not_null
  amount DOUBLE PRECISION not_null
  per_pax BOOLEAN not_null
  created_at TIMESTAMPTZ not_null
}

table whatsapp_daily_stats {
  date DATE primary_key
  messages_sent INT not_null
  daily_limit INT not_null
}

table registration_otp_codes {
  id UUID primary_key
  email VARCHAR not_null
  otp_code VARCHAR not_null
  expires_at TIMESTAMPTZ not_null
  consumed_at TIMESTAMPTZ
  created_at TIMESTAMPTZ not_null
}

table fishing_alieus {
  id UUID primary_key
  slug TEXT not_null
  name TEXT not_null
  description TEXT
  logo_url TEXT
  contact_email TEXT
  contact_phone TEXT
  address TEXT
  city TEXT
  rating DOUBLE PRECISION
  review_count INT
  is_verified BOOLEAN
  is_active BOOLEAN
  created_at TIMESTAMPTZ
  updated_at TIMESTAMPTZ
}

table webhook_logs {
  id UUID primary_key
  provider TEXT not_null
  event_type TEXT
  status TEXT not_null
  reference_id TEXT
  payload JSONB not_null
  headers JSONB
  error_message TEXT
  created_at TIMESTAMPTZ not_null
}

unique index articles_slug_key on articles (slug)
unique index cloudflare_images_image_id_key on cloudflare_images (image_id)
unique index destination_harbors_destination_id_harbor_id_key on destination_harbors (destination_id, harbor_id)
unique index destinations_slug_key on destinations (slug)
unique index email_templates_slug_key on email_templates (slug)
unique index fishing_alieus_pkey1 on fishing_alieus (id)
unique index fishing_alieus_slug_key on charters_alieus (slug)
unique index fishing_alieus_slug_key1 on fishing_alieus (slug)
unique index fishing_diathesi_drasimos_id_available_date_start_time_key on charters_diathesi (drasimos_id, available_date, start_time)
unique index fishing_diathesi_drasimos_id_available_date_start_time_key1 on fishing_diathesi (drasimos_id, available_date, start_time)
unique index fishing_diathesi_pkey1 on fishing_diathesi (id)
unique index fishing_drasimos_pkey1 on fishing_drasimos (id)
unique index fishing_drasimos_slug_key on charters_drasimos (slug)
unique index fishing_drasimos_slug_key1 on fishing_drasimos (slug)
unique index fishing_kratisei_pkey1 on fishing_kratisei (id)
unique index fishing_skaphos_pkey1 on fishing_skaphos (id)
unique index fishing_skaphos_slug_key on charters_skaphos (slug)
unique index fishing_skaphos_slug_key1 on fishing_skaphos (slug)
unique index harbors_slug_key on harbors (slug)
unique index oauth_accounts_provider_provider_user_id_key on oauth_accounts (provider, provider_user_id)
unique index odyssey_connections_odyssey_id_origin_harbor_id_destination_key on odyssey_connections (odyssey_id, origin_harbor_id, destination_harbor_id)
unique index odyssey_legs_odyssey_seq on odyssey_legs (odyssey_id, sequence_order)
unique index odyssey_pricing_tiers_plan_id_market_pax_type_key on odyssey_pricing_tiers (plan_id, market, pax_type)
unique index operators_slug_key on operators (slug)
unique index orders_booking_number_key on orders (booking_number)
unique index orders_invoice_number_key on orders (invoice_number)
unique index payment_sessions_session_id_key on payment_sessions (session_id)
unique index pricing_tiers_plan_market_pax on pricing_tiers (plan_id, market, pax_type)
unique index promotion_uses_promotion_id_order_id_key on promotion_uses (promotion_id, order_id)
unique index promotions_code_key on promotions (code)
unique index redirects_source_path_key on redirects (source_path)
unique index refresh_tokens_token_key on refresh_tokens (token)
unique index search_location_stats_location_type_location_id_key on search_location_stats (location_type, location_id)
unique index ssl_certificates_domain_key on ssl_certificates (domain)
unique index unique_company_schedule on operator_schedule_table (company_id, origin, destination, departure_time)
unique index unique_postmark_event on postmark_events (message_id, event_type, recipient, processed_at)
unique index uq_leg_inventory_leg_date on odyssey_leg_inventory (leg_id, service_date)
unique index user_email_verifications_token_key on user_email_verifications (token)
unique index user_password_resets_token_key on user_password_resets (token)
unique index vessel_class_options_value_key on vessel_class_options (value)
unique index vessel_type_options_value_key on vessel_type_options (value)
unique index vessels_slug_key on vessels (slug)
unique index whatsapp_contacts_phone_number_key on whatsapp_contacts (phone_number)
unique index whatsapp_phone_configs_phone_number_id_key on whatsapp_phone_configs (phone_number_id)
index idx_ai_knowledge_base_keywords on ai_knowledge_base (keywords)
index idx_articles_author on articles (author_id)
index idx_articles_category on articles (category)
index idx_articles_created_at on articles (created_at)
index idx_articles_deleted_at on articles (deleted_at)
index idx_articles_featured on articles (is_featured)
index idx_articles_published_at on articles (published_at)
index idx_articles_slug on articles (slug)
index idx_articles_status on articles (status)
index idx_cf_image_attachments_entity on cloudflare_image_attachments (entity_type, entity_id)
index idx_cf_image_attachments_featured on cloudflare_image_attachments (is_featured = true)
index idx_cf_image_attachments_image_id on cloudflare_image_attachments (image_id)
unique index idx_cf_image_attachments_unique on cloudflare_image_attachments (field_name IS NOT NULL)
index idx_charters_diathesi_date on charters_diathesi (available_date)
index idx_charters_diathesi_drasimos on charters_diathesi (drasimos_id)
index idx_charters_drasimos_category on charters_drasimos (category)
index idx_charters_drasimos_published on charters_drasimos (is_published)
index idx_charters_drasimos_skaphos on charters_drasimos (skaphos_id)
index idx_charters_drasimos_style on charters_drasimos (charter_style)
index idx_charters_kratisei_date on charters_kratisei (booking_date)
index idx_charters_kratisei_drasimos on charters_kratisei (drasimos_id)
index idx_charters_kratisei_status on charters_kratisei (status)
index idx_charters_skaphos_alieus on charters_skaphos (alieus_id)
index idx_charters_skaphos_category on charters_skaphos (category)
index idx_charters_skaphos_destination on charters_skaphos (destination_id IS NOT NULL)
index idx_charters_skaphos_harbor on charters_skaphos (harbor_id IS NOT NULL)
index idx_charters_skaphos_type on charters_skaphos (vessel_type)
index idx_cloudflare_images_deleted_at on cloudflare_images (deleted_at)
unique index idx_cloudflare_images_image_id on cloudflare_images (image_id)
index idx_cloudflare_images_uploaded_at on cloudflare_images (uploaded_at DESC)
index idx_cloudflare_images_uploaded_by on cloudflare_images (uploaded_by)
index idx_destination_harbors_destination on destination_harbors (destination_id)
index idx_destination_harbors_harbor on destination_harbors (harbor_id)
index idx_destination_harbors_primary on destination_harbors (destination_id, is_primary)
index idx_destinations_active on destinations (is_active)
index idx_destinations_active_popular on destinations (is_active = true)
index idx_destinations_created_by on destinations (created_by)
index idx_destinations_deleted_at on destinations (deleted_at)
index idx_destinations_popular on destinations (is_popular = true)
index idx_destinations_position on destinations ("position")
index idx_destinations_slug on destinations (slug)
index idx_destinations_updated_by on destinations (updated_by)
index idx_email_templates_active on email_templates (is_active = true)
index idx_email_templates_category on email_templates (category)
index idx_email_templates_slug on email_templates (slug)
index idx_fishing_diathesi_date on fishing_diathesi (available_date)
index idx_fishing_diathesi_drasimos on fishing_diathesi (drasimos_id)
index idx_fishing_drasimos_category on fishing_drasimos (category)
index idx_fishing_drasimos_published on fishing_drasimos (is_published)
index idx_fishing_drasimos_skaphos on fishing_drasimos (skaphos_id)
index idx_fishing_drasimos_style on fishing_drasimos (fishing_style)
index idx_fishing_kratisei_date on fishing_kratisei (booking_date)
index idx_fishing_kratisei_drasimos on fishing_kratisei (drasimos_id)
index idx_fishing_kratisei_status on fishing_kratisei (status)
index idx_fishing_skaphos_alieus on fishing_skaphos (alieus_id)
index idx_fishing_skaphos_category on fishing_skaphos (category)
index idx_fishing_skaphos_destination on fishing_skaphos (destination_id IS NOT NULL)
index idx_fishing_skaphos_harbor on fishing_skaphos (harbor_id IS NOT NULL)
index idx_fishing_skaphos_type on fishing_skaphos (vessel_type)
unique index idx_flow_config_active_trigger on whatsapp_flow_config (is_active = true)
index idx_flow_config_trigger_type on whatsapp_flow_config (trigger_type)
index idx_harbor_images_deleted_at on harbor_images (deleted_at)
index idx_harbor_images_display_order on harbor_images (harbor_id, display_order)
index idx_harbor_images_featured on harbor_images (is_featured = true)
index idx_harbor_images_harbor_id on harbor_images (harbor_id)
unique index idx_harbor_images_one_featured on harbor_images (deleted_at IS NULL))
index idx_harbors_active on harbors (is_active)
index idx_harbors_created_by on harbors (created_by)
index idx_harbors_facilities on harbors (facilities)
index idx_harbors_location on harbors (longitude IS NOT NULL))
index idx_harbors_position on harbors ("position")
index idx_harbors_slug on harbors (slug)
index idx_harbors_updated_by on harbors (updated_by)
index idx_holds_expires_at on holds (expires_at)
index idx_holds_idempotency_key on holds (idempotency_key)
index idx_holds_status on holds (status)
index idx_idempotency_expires on idempotency_keys (expires_at)
index idx_leg_inventory_available on odyssey_leg_inventory (capacity - reserved) > 0)
index idx_leg_inventory_date on odyssey_leg_inventory (service_date)
index idx_leg_inventory_lookup on odyssey_leg_inventory (leg_id, service_date)
index idx_leg_inventory_odyssey on odyssey_leg_inventory (odyssey_id)
index idx_oauth_accounts_provider on oauth_accounts (provider)
index idx_oauth_accounts_user_id on oauth_accounts (user_id)
index idx_odyssey_connections_enabled on odyssey_connections (is_enabled = true)
index idx_odyssey_connections_odyssey on odyssey_connections (odyssey_id)
index idx_odyssey_connections_origin_dest on odyssey_connections (origin_harbor_id, destination_harbor_id)
index idx_odyssey_legs_harbors on odyssey_legs (from_harbor_id, to_harbor_id)
index idx_odyssey_legs_odyssey on odyssey_legs (odyssey_id)
index idx_odyssey_pricing_fees_plan on odyssey_pricing_fees (plan_id)
index idx_odyssey_pricing_plans_active on odyssey_pricing_plans (is_active = true)
index idx_odyssey_pricing_plans_connection on odyssey_pricing_plans (connection_id IS NOT NULL)
index idx_odyssey_pricing_plans_dates on odyssey_pricing_plans (start_date, end_date)
index idx_odyssey_pricing_plans_odyssey on odyssey_pricing_plans (odyssey_id)
index idx_odyssey_pricing_tiers_plan on odyssey_pricing_tiers (plan_id)
index idx_odysseys_active on odysseys (is_active = true)
index idx_odysseys_booking_config on odysseys (booking_window_days, sales_lead_time_hours)
index idx_odysseys_vessel on odysseys (vessel_id)
index idx_operator_boarding_points_deleted_at on operator_boarding_points (deleted_at IS NULL)
index idx_operator_boarding_points_location on operator_boarding_points (latitude, longitude)
index idx_operator_boarding_points_primary on operator_boarding_points (is_primary = true)
index idx_operator_facilities_deleted_at on operator_facilities (deleted_at IS NULL)
index idx_operator_facilities_operator_id on operator_facilities (operator_id)
index idx_operator_offices_is_main on operator_offices (is_main_office = true)
index idx_operator_offices_operator_id on operator_offices (operator_id)
index idx_operator_schedule_company on operator_schedule_table (company_id)
index idx_operator_schedule_destination_harbor on operator_schedule_table (destination_harbor_id)
index idx_operator_schedule_origin_harbor on operator_schedule_table (origin_harbor_id)
index idx_operators_arrival_dock_id on operators (default_arrival_dock_id)
index idx_operators_brand_name on operators (deleted_at IS NULL)
index idx_operators_created_at on operators (created_at)
index idx_operators_created_by on operators (created_by)
index idx_operators_deleted_at on operators (deleted_at)
index idx_operators_departure_dock_id on operators (default_departure_dock_id)
index idx_operators_is_active on operators (is_active)
index idx_operators_operator_type on operators (operator_type)
index idx_operators_parent_id on operators (parent_operator_id)
index idx_operators_slug on operators (slug)
index idx_operators_updated_at on operators (updated_at)
index idx_operators_updated_by on operators (updated_by)
index idx_order_modifications_expires on order_modifications (status)::text = 'pending'::text)
index idx_order_modifications_order on order_modifications (order_id)
index idx_order_modifications_status on order_modifications (status)::text = 'pending'::text)
unique index idx_order_modifications_token on order_modifications (approval_token)
index idx_order_requests_order_id on order_requests (order_id)
index idx_order_requests_status on order_requests (status)
index idx_order_requests_user_id on order_requests (user_id)
index idx_orders_created_at on orders (created_at DESC)
index idx_orders_hold_id on orders (hold_id IS NOT NULL)
index idx_orders_status on orders (status)
index idx_orders_user_id on orders (user_id IS NOT NULL)
index idx_orders_voyage_id on orders (voyage_id IS NOT NULL)
index idx_password_resets_expires_at on user_password_resets (expires_at)
index idx_password_resets_token on user_password_resets (token)
index idx_password_resets_user_id on user_password_resets (user_id)
index idx_payment_events_created_at on payment_events (created_at DESC)
index idx_payment_events_event_type on payment_events (event_type)
index idx_payment_events_payment_session_id on payment_events (payment_session_id)
index idx_payment_events_session_id on payment_events (payment_session_id)
unique index idx_payment_sessions_active_per_order on payment_sessions (ARRAY['Pending'::text, 'AwaitingPayment'::text, 'Authorized'::text]))
index idx_payment_sessions_expires_at on payment_sessions (expires_at)
index idx_payment_sessions_order_id on payment_sessions (order_id)
index idx_payment_sessions_payment_request_id on payment_sessions (payment_request_id IS NOT NULL)
index idx_payment_sessions_session_id on payment_sessions (session_id)
index idx_payment_sessions_status on payment_sessions (status)
index idx_payment_sessions_xendit_session_id on payment_sessions (xendit_session_id IS NOT NULL)
index idx_popular_tickets_active on popular_tickets (is_active)
index idx_popular_tickets_active_position on popular_tickets (is_active = true)
index idx_popular_tickets_operator on popular_tickets (operator_id IS NOT NULL)
index idx_popular_tickets_position on popular_tickets ("position")
index idx_postmark_events_created_at on postmark_events (created_at)
index idx_postmark_events_email on postmark_events (email)
index idx_postmark_events_event_type on postmark_events (event_type)
index idx_postmark_events_failed on postmark_events (processing_status)::text = 'failed'::text)
index idx_postmark_events_message_id on postmark_events (message_id)
index idx_postmark_events_message_recipient on postmark_events (message_id, recipient)
index idx_postmark_events_processed_at on postmark_events (processed_at)
index idx_postmark_events_recipient on postmark_events (recipient)
index idx_postmark_events_server_id on postmark_events (server_id)
index idx_postmark_events_status on postmark_events (processing_status)
index idx_postmark_events_tag on postmark_events (tag)
index idx_postmark_events_type_recipient_time on postmark_events (event_type, recipient, processed_at DESC)
index idx_pricing_fees_plan on pricing_fees (plan_id)
index idx_pricing_plans_dates on pricing_plans (start_date, end_date)
index idx_pricing_plans_parent_route on pricing_plans (parent_route_id IS NOT NULL)
index idx_pricing_plans_segment on pricing_plans (segment_id IS NOT NULL)
index idx_pricing_tiers_plan on pricing_tiers (plan_id)
index idx_promotion_uses_customer_email on promotion_uses (customer_email)
index idx_promotion_uses_order_id on promotion_uses (order_id)
index idx_promotion_uses_promotion_id on promotion_uses (promotion_id)
index idx_promotions_code on promotions (code)
index idx_promotions_dates on promotions (starts_at, expires_at)
index idx_promotions_is_active on promotions (is_active)
index idx_redirects_created_at on redirects (created_at DESC)
index idx_redirects_is_active on redirects (is_active)
index idx_redirects_source_path on redirects (source_path)
index idx_refresh_tokens_created_at on refresh_tokens (created_at)
index idx_refresh_tokens_expires_at on refresh_tokens (expires_at)
index idx_refresh_tokens_token on refresh_tokens (token)
index idx_refresh_tokens_user_id on refresh_tokens (user_id)
index idx_registration_otp_codes_email on registration_otp_codes (email)
index idx_registration_otp_codes_email_code on registration_otp_codes (consumed_at IS NULL)
index idx_registration_otp_codes_expires_at on registration_otp_codes (expires_at)
index idx_reservations_created_at on reservations (created_at DESC)
index idx_reservations_status on reservations (status)
index idx_search_location_stats_location on search_location_stats (location_type, location_id)
index idx_search_location_stats_popularity on search_location_stats (location_type, selection_count DESC)
index idx_seo_comparisons_published on seo_comparisons (is_published)
unique index idx_seo_comparisons_slug on seo_comparisons (slug)
index idx_seo_comparisons_type on seo_comparisons (comparison_type)
index idx_seo_kairos_destination on seo_kairos (destination)
index idx_seo_kairos_published on seo_kairos (is_published)
unique index idx_seo_kairos_slug on seo_kairos (slug)
index idx_seo_poros_dest_dest_id on seo_poros (dest_destination_id)
index idx_seo_poros_dest_harbor_id on seo_poros (dest_harbor_id)
index idx_seo_poros_origin_dest_id on seo_poros (origin_destination_id)
index idx_seo_poros_origin_destination on seo_poros (origin, destination)
index idx_seo_poros_origin_harbor_id on seo_poros (origin_harbor_id)
index idx_seo_poros_published on seo_poros (is_published)
unique index idx_seo_poros_slug on seo_poros (slug)
index idx_service_groups_active on service_groups (is_active = true)
index idx_service_groups_category on service_groups (category)
index idx_service_groups_class on service_groups (class)
index idx_service_groups_sort_order on service_groups (sort_order)
index idx_ssl_certificates_domain_active on ssl_certificates (is_active = true)
index idx_ssl_certificates_expires_at on ssl_certificates (is_active = true)
index idx_user_email_verifications_expires_at on user_email_verifications (expires_at)
index idx_user_email_verifications_user_id on user_email_verifications (user_id)
index idx_vessel_facilities_deleted_at on vessel_facilities (deleted_at)
index idx_vessel_facilities_vessel_id on vessel_facilities (vessel_id)
index idx_vessel_images_deleted_at on vessel_images (deleted_at)
index idx_vessel_images_display_order on vessel_images (vessel_id, display_order)
index idx_vessel_images_vessel_id on vessel_images (vessel_id)
index idx_vessels_active_since on vessels (active_since)
index idx_vessels_arrival_dock_id on vessels (default_arrival_dock_id)
index idx_vessels_created_at on vessels (created_at)
index idx_vessels_created_by on vessels (created_by)
index idx_vessels_deleted_at on vessels (deleted_at)
index idx_vessels_departure_dock_id on vessels (default_departure_dock_id)
index idx_vessels_is_active on vessels (is_active)
index idx_vessels_operator_id on vessels (operator_id)
index idx_vessels_slug on vessels (slug)
index idx_vessels_updated_at on vessels (updated_at)
index idx_vessels_updated_by on vessels (updated_by)
index idx_vessels_vessel_class on vessels (vessel_class)
index idx_vessels_vessel_type on vessels (vessel_type)
index idx_webhook_logs_provider_created_at on webhook_logs (provider, created_at DESC)
index idx_webhook_logs_status_created_at on webhook_logs (status, created_at DESC)
index idx_whatsapp_broadcast_recipients_status on whatsapp_broadcast_recipients (broadcast_id, status)
index idx_whatsapp_broadcasts_created on whatsapp_broadcasts (created_at DESC)
index idx_whatsapp_broadcasts_status on whatsapp_broadcasts (status)
index idx_whatsapp_contact_groups_name on whatsapp_contact_groups (name)
index idx_whatsapp_contacts_phone on whatsapp_contacts (phone_number)
index idx_whatsapp_messages_created on whatsapp_messages (created_at DESC)
index idx_whatsapp_messages_order on whatsapp_messages (order_id IS NOT NULL)
index idx_whatsapp_messages_our_phone on whatsapp_messages (our_phone_number_id IS NOT NULL)
index idx_whatsapp_messages_phone on whatsapp_messages (phone_number)
index idx_whatsapp_messages_read_status on whatsapp_messages (read_at IS NULL))
index idx_whatsapp_messages_session on whatsapp_messages (session_id IS NOT NULL)
index idx_whatsapp_messages_wa_id on whatsapp_messages (wa_message_id IS NOT NULL)
index idx_whatsapp_phone_configs_phone_number_id on whatsapp_phone_configs (phone_number_id)
index idx_whatsapp_sessions_phone_active on whatsapp_sessions (status)::text = 'active'::text)
index idx_whatsapp_sessions_phone_history on whatsapp_sessions (phone_number, created_at DESC)
index idx_whatsapp_sessions_stale on whatsapp_sessions (status)::text = 'active'::text)
